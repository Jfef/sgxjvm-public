<!DOCTYPE html> <!-- index.html -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SGX Random number generator</title>
    <link rel="stylesheet" href="stylesheet.css">
</head>
<body>
<div class="generate_floating_wrapper">
    <div class="generate_floating">
        <button id="generate_button_id" type="button" style="display:block">Generate</button>
        <button id="reload_button_id" type="button" style="display:block">Reload enclave</button>
    </div>
</div>
<div id="generate_error_id"></div>
<div id="chain_of_trust_id">
    <div class="chain_of_trust_element hidden" id="ias_certificate_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The Intel Attestation Service's report signing key's certificate, as reported by the service. It should
            match the one published on Intel's website here:
            <a href="https://software.intel.com/sites/default/files/managed/7b/de/RK_PUB.zip">
                https://software.intel.com/sites/default/files/managed/7b/de/RK_PUB.zip
            </a>
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="ias_signature_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The signature of the report signing key over the Intel Attestation Service's response to the quote
            validating query.
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="ias_response_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The response of the Intel Attestation Service to the GET request that requested the validation of the
            enclave's quote.
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="enclave_quote_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The quote produced by the Quoting Enclave. Note that this is a separate enclave to the RNG enclave. The way
            it works is that the RNG Enclave produces a *report*, which is then send to the Quoting Enclave for signing.
            The Quoting Enclave uses an attestation key retrieved during EPID provisioning. For more info on this see
            <a href="https://software.intel.com/en-us/download/intel-sgx-intel-epid-provisioning-and-attestation-services">
                https://software.intel.com/en-us/download/intel-sgx-intel-epid-provisioning-and-attestation-services
            </a>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>version</b>:
                </div>
                <div>
                    The version number of the Quoting Enclave. This is burnt into the enclave itself.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>quoteType</b>:
                </div>
                <div>
                    The type of the EPID quote. It is either LINKABLE or UNLINKABLE.
                    "Linkability" relates to the EPID provisioning protocol. This is a blind join protocol used to
                    create the attestation key that the Quoting Enclave will use to sign reports generated by your
                    enclave. The protocol ensures that when you send a signed quote to the Intel Attestation Service for
                    verification, Intel won't be able to identify which CPU produced the quote. Furthermore if the quote
                    is *unlinkable* then Intel (or anyone else) won't be able to tell whether two separate quotes came
                    from the same CPU. *Linkable* quotes are still unidentifiable, but two such quotes coming from the
                    same CPU may be correlated. See
                    <a href="https://software.intel.com/en-us/articles/signature-policy">
                        https://software.intel.com/en-us/articles/signature-policy
                    </a>
                    for further details.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>epidGroupId</b>:
                </div>
                <div>
                    The EPID Group that the CPU belongs to that generated the quote.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>qeIsvSvn</b>:
                </div>
                <div>
                    The ISV Security Version Number of the Quoting Enclave. Note that this is different to CPUSVN, it's
                    determined by the author of the enclave, Intel in this case. This version number may be used during
                    key derivation, and keys of older versions may be derived, provided the key request was constructed
                    correctly. For example for sealing key derivations the key must be derived using MRSIGNER and not
                    with MRENCLAVE for this to happen.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>pceIsvSvn</b>:
                </div>
                <div>
                    The ISV Security Version Number of the Provisioning Certifying Enclave. This is similar to qeIsvSvn,
                    only it's targetting the PCE. The PCE is another architectural enclave that is part of the EPID
                    provisioning protocol. During provisioning this enclave is involved in a mini-attestation protocol
                    which proves to Intel that the CPU is genuine. The PCE has unique privileges that allows it to
                    derive certain CPU signing keys that Intel can correlate on their end. Once the CPU is proven to be
                    genuine the EPID provisioning proceeds with the creation of the attestation key (by yet another
                    enclave, the PvE), to be used by the Quoting Enclave later on for quote signing.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>externalEpidGroupId</b>:
                </div>
                <div>
                    Always 0.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>reportBody</b>:
                </div>
                <div>
                    The RNG enclave's report's body. Note how the quote doesn't contain the full report, namely the
                    CPU's MAC over the report is missing. This is deliberate.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>cpuSvn</b>:
                </div>
                <div>
                    The CPU Security Version Number of the RNG enclave. This is an opaque number identifying the
                    microcode version and versions of various subcomponents of the CPU. The only valid comparison
                    operation on it is equality, i.e. greater-than comparisons are meaningless. The only limited
                    exception to this is EGETKEY, which can derive the same keys targetting older CPUSVNs.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>miscSelect</b>:
                </div>
                <div>
                    Bits indicating which extended SGX features can be written to the SSA when an asynchronous exception
                    (AEX) occurs. Only a single bit is meaningful currently, which causes the CPU to save information
                    into the SSA about certain CPU exceptions, namely General Protection exceptions and Page Faults.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>attributes.flags</b>:
                </div>
                <div>
                    Flags indicating what kind of state the enclave is in.
                    <ul>
                        <li>
                            INITTED: the enclave is initialized
                        </li>
                        <li>
                            DEBUG: the enclave is loaded in debug mode.
                            <br><b>THE ENCLAVE IS NOT TO BE TRUSTED IF THIS IS SET</b>
                        </li>
                        <li>
                            MODE64BIT: if set the enclave is 64bit, if unset it's 32bit.
                            <br><b>THE ENCLAVE IS NOT TO BE TRUSTED IF THIS IS UNSET</b>
                        </li>
                        <li>
                            PROVISION_KEY: the enclave can derive provisioning keys. Only the PCE has this set.
                        </li>
                        <li>
                            EINITTOKEN_KEY: the enclave can derive init token keys. Only the LE (Launching Enclave) has
                            this set.
                        </li>
                    </ul>
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>attributes.xfrm</b>:
                </div>
                <div>
                    X-Feature Request Mask. This is a mask of the extended CPU features the enclave may use. This must
                    be a subset of the enabled CPU features as indicated by XCR0 at the time of enclave loading.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>measurement</b>:
                </div>
                <div>
                    The measurement of the enclave. This is the enclave image's hash, and it identifies a specific
                    enclave build. For all intents and purposes this is *the* identifier of an enclave image, although
                    other data must also be taken into account when establishing trust in a specific enclave instance.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>mrsigner</b>:
                </div>
                <div>
                    The SHA-256 hash of the enclave's signing key. This key must have a specific format, it must be a
                    3072 bit RSA key with exponent 3. It must also be whitelisted by Intel, otherwise the enclave can't
                    be loaded in non-DEBUG mode (see attributes.flags). This whitelist is retrieved by the aesmd daemon
                    and checked by the Launching Enclave before granting permission to load the enclave in non-DEBUG
                    mode.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>isvProdId</b>:
                </div>
                <div>
                    The "Product ID", as specified by the enclave author (in this case the RNG enclave's author). This
                    is a number that identifies the purpose of the enclave. For example a company may release different
                    enclaves for different purposes. In this case they should be versioned separately, and this affects
                    key derivation. Enclave A should not have access to key of enclave B. This ID identifies one such
                    type of enclave.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>isvSvn</b>:
                </div>
                <div>
                    The ISV Software Version Number of the enclave producing the report in the quote, in this case the
                    RNG enclave.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>reportData</b>:
                </div>
                <div>
                    A piece of arbitrary data produced by the enclave that is included in the report. A typical payload
                    is a hash of a public key, the private key of which was produced by the enclave. This can be used
                    to extend the chain of trust further, authenticate the enclave, have it sign over some other
                    produced data etc. In the RNG enclave's case it's the SHA-512 hash of a public key created
                    dynamically. The private key is used to sign the random bytes produced by the enclave.
                </div>
            </div>

            <div style="display:flex;">
                <div style="min-width:200px;">
                    <b>signature</b>:
                </div>
                <div>
                    The Quoting Enclave's signature, created using the EPID attestation key.
                </div>
            </div>
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="enclave_public_key_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The RNG enclave's public key. The SHA-512 hash of this key can be found in the quote's reportData.
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="enclave_signature_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            The enclave's signature over the random bytes
        </div>
    </div>
    <div class="chain_of_trust_element hidden" id="generated_bytes_id">
        <div class="chain_of_trust_data"></div>
        <div class="chain_of_trust_description">
            Finally, these are the random bytes generated by our enclave. Under the hood they were produced using the
            x86 RDRAND instruction.
        </div>
    </div>
</div>

<script type="text/javascript" src="js/kotlin.js"></script>
<script type="text/javascript" src="js/frontend.js"></script>
</body>
</html>
